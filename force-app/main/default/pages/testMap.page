<apex:page sidebar="false" showHeader="false" docType="html-5.0">
  <html>
    <head>
      <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
      <style>
        html, body, #map {
          height: 100%;
          margin: 0;
          padding: 0;
        }
      </style>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjE09NfSW5HZpwg1CU5_QZ6u76UOSrxZE&libraries=geometry"></script>
    </head>
    <body>
      <div id="map"></div>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          const map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 39.8283, lng: -98.5795 },
            zoom: 4,
          });

          // Load state boundaries
          fetch('/resource/tempStates')
            .then(res => res.json())
            .then(stateGeojson => {
              map.data.addGeoJson(stateGeojson);
              map.data.setStyle({
                fillColor: 'blue',
                strokeColor: 'white',
                strokeWeight: 1,
                fillOpacity: 0.1
              });
            });

          // Load congressional district boundaries
          fetch('/resource/tempDistricts')
            .then(res => res.json())
            .then(districtGeojson => {
              map.data.addGeoJson(districtGeojson);
              // You can apply a different style if desired
              map.data.setStyle(feature => {
                const type = feature.getProperty('NAMELSAD') ? 'district' : 'state';
                return {
                  fillColor: type === 'district' ? 'green' : 'blue',
                  strokeColor: type === 'district' ? 'black' : 'white',
                  strokeWeight: 1,
                  fillOpacity: type === 'district' ? 0.2 : 0.1
                };
              });
            });

            map.data.addListener('click', function (event) {

                event.feature.forEachProperty((value, name) => {
                console.log(`${name}:`, value);
                });
                            
                const name = event.feature.getProperty('NAMELSAD') || event.feature.getProperty('name') || event.feature.getProperty('GEOID');
                alert(`You clicked on: ${name}`);
            });
        });
      </script>
    </body>
  </html>
</apex:page>
