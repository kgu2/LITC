<template>
  <template if:true={_isFirstIndex}>
    <!-- Header/Label -->
    <label aria-label={_propSetMap.label}
           class="slds-form-element__label slds-m-bottom_medium slds-section-title"
           aria-live="polite">
      {_propSetMap.label}
    </label>

    <!-- Global Actions -->
    <div if:true={_propSetMap.gActions}
         class="slds-grid slds-wrap">
      <template for:each={_gActions}
                for:item='gActionItem'
                for:index='gActionIndex'>
        <template if:true={gActionItem.hasIcon}>
          <div key={gActionItem.lwcId}
               class="slds-m-bottom_xx-small slds-m-right_xx-small">
            <c-icon extraclass="slds-input__icon"
                    icon-name={gActionItem.icon}
                    theme="slds"
                    alternative-text={gActionItem.label}
                    size="small"
                    style="cursor:pointer"
                    tabindex="0"
                    role="button"
                    onclick={gActionItem.handleClick}>
            </c-icon>
          </div>
        </template>
        <template if:false={gActionItem.hasIcon}>
          <div key={gActionItem.lwcId}
               class={gActionItem.cls}>
            <div class="slds-m-bottom_x-small slds-m-right_xx-small">
              <button class="slds-button slds-button_neutral slds-button_brand slds-size_1-of-1"
                      onclick={gActionItem.handleClick}>
                {gActionItem.label}
              </button>
            </div>
          </div>
        </template>
      </template>
    </div>
  </template>

  <div class="slds-grid slds-wrap">
    <!-- Inline Visual -->
    <div class={visualClass}
         style="cursor:pointer;">
      <div class="slds-box slds-grid slds-size_1-of-1 slds-m-bottom_medium"
           onclick={edit}
           data-edit-action='default'
           role="button"
           tabindex="0"
           onkeydown={handleKeyboardEdit}>
        <!-- Customizable SVG Icon -->
        <c-icon class="slds-grid slds-grid_vertical-align-center"
                extraclass="slds-input__icon"
                icon-name={svgMapIcon}
                theme="slds"
                alternative-text="icon"
                aria-hidden="true"
                color="#05a6df"
                size="large">
        </c-icon>
        <!-- Display Text -->
        <div class="slds-max-small-size_5-of-12 slds-small-size_8-of-12 slds-grid slds-grid_vertical slds-grid_align-center slds-grid_vertical-align">
          <template for:each={_displayValues}
                    for:item='dvItem'
                    for:index='dvIndex'>
            <div key={dvItem.lwcId}
                 class="slds-size_12-of-12 slds-p-left_x-small slds-form-element__label slds-truncate">
              {dvItem.value}
            </div>
          </template>
        </div>
        <div class="slds-size_1-of-12 slds-grid slds-grid_align-center slds-grid_vertical-align-center slds-col_bump-left">
          <span class="slds-required slds-grid slds-grid_vertical-align-center slds-p-right_xx-small slds-text-heading_medium"
                if:true={showAsterisk}>
            *
          </span>
          <template if:true={_allowDelete}>
            <c-icon extraclass="slds-input__icon"
                    icon-name="utility:close"
                    theme="slds"
                    alternative-text={allCustomLabelsUtil.OmniDelete}
                    size="small"
                    onclick={remove}
                    tabindex="0"
                    role="button"
                    data-remove-button
                    onkeydown={handleKeyboardRemove}>
            </c-icon>
          </template>
        </div>
      </div>
    </div>

    <!-- Inline Editing -->
    <div class={editClass}>
      <article class="slds-box slds-m-bottom_medium">
        <h2 class="slds-m-bottom_small">{_propSetMap.label}</h2>
        <slot class="slds-grid slds-wrap"></slot>
        <div class="slds-grid slds-wrap slds-grid_align-end slds-m-top_medium">
          <button onclick={cancel}
                  class="slds-button slds-button_neutral slds-size_2-of-12 slds-text-align_center">
            {allCustomLabelsUtil.OmnicancelLabel}
          </button>
          <button onclick={save}
                  disabled={isPageLoading}
                  class="slds-button slds-button_neutral slds-size_2-of-12 slds-text-align_center">
            {allCustomLabelsUtil.OmniConfigProdModalOk}
          </button>
        </div>
      </article>
    </div>

    <!-- Inline Add Button -->
    <div if:true={showAdd}
         class="slds-box slds-grid slds-m-bottom_medium slds-size_1-of-1"
         onclick={handleAdd}
         style="cursor:pointer"
         role="button"
         tabindex="0"
         onkeydown={handleKeyboardAdd}>
      <c-icon extraclass="slds-input__icon"
              icon-name="utility:add"
              theme="slds"
              alternative-text="add icon"
              size="large">
      </c-icon>
      <span class="slds-grid slds-grid_align-center slds-grid_vertical-align-center slds-p-left_x-small slds-form-element__label">
        {_newLabel}
      </span>
    </div>
  </div>

  <!-- Spinner -->
  <template if:true={isPageLoading}>
    <c-spinner variant="brand"
               alternative-text={allCustomLabelsUtil.OmniSavingAccessibleLabel}
               theme={_theme}
               size="medium">
    </c-spinner>
  </template>
</template>